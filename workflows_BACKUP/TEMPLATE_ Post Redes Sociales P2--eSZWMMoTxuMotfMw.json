{"updatedAt":"2026-01-05T21:52:45.000Z","createdAt":"2026-01-05T21:52:45.499Z","id":"eSZWMMoTxuMotfMw","name":"TEMPLATE: Post Redes Sociales P2","description":null,"active":false,"isArchived":false,"nodes":[{"parameters":{"rule":{"interval":[{"field":"weeks","triggerAtDay":[1,2,3,4,5],"triggerAtHour":9}]}},"type":"n8n-nodes-base.scheduleTrigger","typeVersion":1.2,"position":[-1024,768],"id":"802f1c12-2f62-4e3c-8d49-38032651631d","name":"Schedule Trigger1"},{"parameters":{"template_id":{"__rl":true,"value":"={{ $('varPostIMG').item.json.Plantilla}}","mode":"id"},"layers":{"layerItems":[{"layerId":"quote|text","property":"text","textValue":"={{ $('varPostIMG').item.json['Frase Clave'][0] }}"},{"layerId":"fondo|picture","property":"imageBinary","imageBinaryValue":"data"},{"layerId":"fondo-color|rectangle","property":"background_color","background_colorValue":"={{ $('varPostIMG').item.json.Color }}"},{"layerId":"decoracion-color|rectangle","property":"background_color","background_colorValue":"={{ $('varPostIMG').item.json.Color }}"}]},"additionalFields":{}},"type":"n8n-nodes-placid.placid","typeVersion":1,"position":[1168,608],"id":"845dadbb-1492-4c40-8d7c-4fba1e1cfbec","name":"Create an image from a template","retryOnFail":true,"waitBetweenTries":5000,"onError":"continueErrorOutput"},{"parameters":{},"type":"n8n-nodes-base.wait","typeVersion":1.1,"position":[2064,384],"id":"80120182-a319-4722-8e0c-a13a93410492","name":"Wait11","webhookId":"4a03badc-00e4-403d-92f5-173d0ec512cd"},{"parameters":{"chatId":"1019249029","text":"=⚠️​ {{ $(\"masterVar\").item.json.Cliente }} ⚠️​\nHubo un error al querer hacer la publicación de hoy publicar","additionalFields":{"appendAttribution":false,"parse_mode":"HTML"}},"type":"n8n-nodes-base.telegram","typeVersion":1.2,"position":[2064,816],"id":"306a9de6-5824-476a-8355-04bb539f5193","name":"⚠️​2","webhookId":"c65b4315-f541-44ce-b6e2-f908447ce407","executeOnce":true},{"parameters":{},"type":"n8n-nodes-base.noOp","typeVersion":1,"position":[3024,480],"id":"b13ae46f-cea3-4d66-a3f9-cfa2ce761b20","name":"No Operation, do nothing2"},{"parameters":{},"type":"n8n-nodes-base.wait","typeVersion":1.1,"position":[1376,592],"id":"4313370e-5d33-4419-9490-309f174bc306","name":"Wait12","webhookId":"29a5f910-875a-4161-9765-734fe0240879"},{"parameters":{},"type":"n8n-nodes-base.wait","typeVersion":1.1,"position":[2064,544],"id":"5a33acb2-88dd-4478-a4d0-fd25820f6038","name":"Wait13","webhookId":"e94a3d72-2d11-417d-b5cb-837230d05209"},{"parameters":{},"type":"n8n-nodes-base.wait","typeVersion":1.1,"position":[1296,1216],"id":"c508ed0a-90be-4875-a642-7c370860da24","name":"Wait15","webhookId":"c24aa6dc-4e11-44f3-b455-9bbae73ab716"},{"parameters":{"options":{}},"type":"n8n-nodes-base.splitInBatches","typeVersion":3,"position":[992,1520],"id":"ba47dc63-623e-42fb-a81c-5a495222a358","name":"Loop Over Items2"},{"parameters":{},"type":"n8n-nodes-base.wait","typeVersion":1.1,"position":[1488,1520],"id":"12713be7-3277-4f20-ae3e-90a454cfe370","name":"Wait16","webhookId":"d06cf44f-80b0-4f4c-a947-762bf726838c"},{"parameters":{"jsCode":"// 1) Normaliza campos y valida, pero solo conserva los que tienen image_url\nconst normalized = items\n  .map((it, pos) => {\n    const j = it.json || {};\n    const indice = Number(j.indice ?? j.index ?? pos + 1);\n    const url =\n      j.image_url ??\n      j.imageUrl ??\n      j.url ??\n      null;\n\n    if (!Number.isFinite(indice)) return null;\n    if (!url || typeof url !== 'string') return null;\n\n    return {\n      indice,\n      image_url: url.trim(),\n    };\n  })\n  .filter(x => x !== null); // elimina los que no tienen image_url\n\n// 2) Eliminar duplicados por indice (conserva el primero)\nconst seen = new Set();\nconst deduped = normalized.filter(({ indice }) => {\n  if (seen.has(indice)) return false;\n  seen.add(indice);\n  return true;\n});\n\n// 3) Ordena por indice ascendente\ndeduped.sort((a, b) => a.indice - b.indice);\n\n// 4) Agrega en estructuras útiles\nconst images = deduped.map(x => x.image_url);\nconst indices = deduped.map(x => x.indice);\nconst images_by_index = Object.fromEntries(\n  deduped.map(x => [String(x.indice), x.image_url])\n);\n\n// 5) Devuelve un único item agregado\nreturn [\n  {\n    json: {\n      count: images.length,\n      images,             // [\"url_slide1\", \"url_slide2\", ...] (ordenado)\n      indices,            // [1,2,3,...] (ordenado)\n      images_by_index     // {\"1\": \"url...\", \"2\": \"url...\", ...}\n    }\n  }\n];"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[1296,1392],"id":"0eae4e4c-6f66-4d82-a82f-212a57b4cd98","name":"Code"},{"parameters":{"assignments":{"assignments":[{"id":"c7738286-9bb2-4b6a-b9d6-ecec57d193e7","name":"indice","value":"={{ $('Loop Over Items2').item.json.indice }}","type":"number"},{"id":"3c59ef3e-a3d8-43d4-848c-f6b90625217e","name":"image_url","value":"={{ $json.image_url }}","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[1712,1520],"id":"3d93be0f-5ea8-49b9-b5e0-e2cbf7d3ae8a","name":"varSlides1"},{"parameters":{},"type":"n8n-nodes-base.merge","typeVersion":3.2,"position":[1504,1328],"id":"1fde6f31-368f-40e1-809b-5e1d3e95f258","name":"Merge4"},{"parameters":{"jsCode":"// Entrada esperada (items del Merge):\n// items[0].json -> portada con image_url\n// items[1].json -> slides con images[], indices[] y/o images_by_index{}\n\nconst inItems = items.map(i => i.json ?? {});\n\n// --- Detectar portada y slides ---\nlet coverUrl = null;\nlet slidePairs = []; // { indice:number, img:string }\n\nfor (const j of inItems) {\n  // Portada\n  if (typeof j.image_url === 'string' && j.image_url.trim()) {\n    coverUrl = j.image_url.trim();\n  } else if (typeof j.portada_url === 'string' && j.portada_url.trim()) {\n    coverUrl = j.portada_url.trim();\n  } else if (typeof j.cover_url === 'string' && j.cover_url.trim()) {\n    coverUrl = j.cover_url.trim();\n  }\n\n  // Slides (varias formas)\n  if (j && typeof j === 'object') {\n    if (j.images_by_index && typeof j.images_by_index === 'object') {\n      for (const [k, v] of Object.entries(j.images_by_index)) {\n        const idx = Number(k);\n        if (Number.isFinite(idx) && typeof v === 'string' && v.trim()) {\n          slidePairs.push({ indice: idx, img: v.trim() });\n        }\n      }\n    } else if (Array.isArray(j.images)) {\n      const imgs = j.images.filter(u => typeof u === 'string' && u.trim());\n      if (Array.isArray(j.indices) && j.indices.length === imgs.length) {\n        for (let i = 0; i < imgs.length; i++) {\n          const idx = Number(j.indices[i]);\n          if (Number.isFinite(idx)) slidePairs.push({ indice: idx, img: imgs[i].trim() });\n        }\n      } else {\n        // sin indices: asumimos orden natural 1..N\n        for (let i = 0; i < imgs.length; i++) {\n          slidePairs.push({ indice: i + 1, img: imgs[i].trim() });\n        }\n      }\n    }\n  }\n}\n\n// --- Deduplicar por indice y ordenar ---\nconst seen = new Set();\nslidePairs = slidePairs.filter(p => {\n  const k = String(p.indice);\n  if (seen.has(k)) return false;\n  seen.add(k);\n  return true;\n}).sort((a, b) => a.indice - b.indice);\n\n// --- Construir salida (un item por imagen) ---\nconst out = [];\n\n// Portada (indice 0) primero, si existe\nif (coverUrl) out.push({ indice: 0, img: coverUrl });\n\n// Luego slides 1..N\nfor (const p of slidePairs) {\n  out.push({ indice: Number(p.indice), img: p.img });\n}\n\n// Validaciones mínimas\nif (out.length === 0) {\n  throw new Error('No se encontraron imágenes de portada ni slides.');\n}\n\n// Devolver un item por imagen (ideal para “cargar el slide” en Blotato)\nreturn out.map(o => ({ json: o }));"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[1712,1328],"id":"e81dd003-c0bf-48d7-9e0d-12f5fd27a935","name":"imgSlide1"},{"parameters":{"options":{}},"type":"n8n-nodes-base.splitInBatches","typeVersion":3,"position":[1920,1328],"id":"ae29d69b-668f-4862-bc2c-cccab2b69670","name":"Loop Over Items3"},{"parameters":{},"type":"n8n-nodes-base.wait","typeVersion":1.1,"position":[2320,1392],"id":"542c87d7-0263-4336-b6a3-43735729158e","name":"Wait17","webhookId":"5e18516b-71f3-4189-9061-223e5fd0ef36"},{"parameters":{"mode":"chooseBranch"},"type":"n8n-nodes-base.merge","typeVersion":3.2,"position":[2304,1072],"id":"09500f9f-782c-414e-a81a-cf9b9d6e5e79","name":"Merge5"},{"parameters":{},"type":"n8n-nodes-base.wait","typeVersion":1.1,"position":[3040,1056],"id":"387b5f4e-7c37-431a-8959-80fe2c5bb3d5","name":"Wait18","webhookId":"d6de74ce-f8bf-4773-941f-aab8774c0784"},{"parameters":{"chatId":"1019249029","text":"=⚠️​ {{ $(\"masterVar\").item.json.Cliente }} ⚠️​\nHubo un error al querer hacer la publicación de hoy publicar","additionalFields":{"appendAttribution":false,"parse_mode":"HTML"}},"type":"n8n-nodes-base.telegram","typeVersion":1.2,"position":[3056,1568],"id":"1bf3da80-6391-457e-8bd2-045afe1c2b2f","name":"⚠️​3","webhookId":"17a26017-b75e-41bc-b788-10653c560707","executeOnce":true},{"parameters":{"chatId":"1019249029","text":"=✅​ {{ $node[\"masterVar\"].json['Cliente'] }} ✅​​\nSe realizó el posteo correctamente","additionalFields":{"appendAttribution":false,"parse_mode":"HTML"}},"type":"n8n-nodes-base.telegram","typeVersion":1.2,"position":[3680,1184],"id":"2c49ee49-d82e-4ace-8ed6-a2da5a9cbb3e","name":"✅​3","webhookId":"d45b8c31-40ba-4733-a56d-c7561a65e4ae","executeOnce":true},{"parameters":{},"type":"n8n-nodes-base.noOp","typeVersion":1,"position":[3888,1472],"id":"7140dd18-ea96-4f89-b8c7-098701b6bf53","name":"No Operation, do nothing3"},{"parameters":{"operation":"create","base":{"__rl":true,"value":"={{ $node[\"masterVar\"].json['airtableBase'] }}","mode":"id"},"table":{"__rl":true,"value":"={{ $node[\"masterVar\"].json['Redes Sociales'] }}","mode":"id"},"columns":{"mappingMode":"defineBelow","value":{"Caption":"={{ $('varPostCarrusel0').item.json['Caption de Facebook'] }}","Frase Clave":"={{ $('varPostCarrusel0').item.json['Frase Clave'].join(\", \").replace(/\\n/g, \" \")  }}","Tipo":"Carrusel","Red Social":"Facebook","Fecha publicación":"={{ $now.toISO() }}","Color":"={{ $('varPostCarrusel0').item.json['Color'] }}"},"matchingColumns":[],"schema":[{"id":"Caption","displayName":"Caption","required":false,"defaultMatch":false,"canBeUsedToMatch":true,"display":true,"type":"string","readOnly":false,"removed":false},{"id":"Frase Clave","displayName":"Frase Clave","required":false,"defaultMatch":false,"canBeUsedToMatch":true,"display":true,"type":"string","readOnly":false,"removed":false},{"id":"Tipo","displayName":"Tipo","required":false,"defaultMatch":false,"canBeUsedToMatch":true,"display":true,"type":"options","options":[{"name":"Imagen","value":"Imagen"},{"name":"Carrusel","value":"Carrusel"},{"name":"Video","value":"Video"}],"readOnly":false,"removed":false},{"id":"Red Social","displayName":"Red Social","required":false,"defaultMatch":false,"canBeUsedToMatch":true,"display":true,"type":"options","options":[{"name":"Facebook","value":"Facebook"},{"name":"Instagram","value":"Instagram"}],"readOnly":false,"removed":false},{"id":"Color","displayName":"Color","required":false,"defaultMatch":false,"canBeUsedToMatch":true,"display":true,"type":"string","readOnly":false,"removed":false},{"id":"Fecha publicación","displayName":"Fecha publicación","required":false,"defaultMatch":false,"canBeUsedToMatch":true,"display":true,"type":"dateTime","readOnly":false,"removed":false}],"attemptToConvertTypes":false,"convertFieldsToString":false},"options":{}},"type":"n8n-nodes-base.airtable","typeVersion":2.1,"position":[3264,1056],"id":"14becc64-1663-4310-9cd8-8054892e6ce4","name":"Create a record6"},{"parameters":{},"type":"n8n-nodes-base.wait","typeVersion":1.1,"position":[3040,1232],"id":"8adccc49-d32f-4911-9c8d-1f074bf14cce","name":"Wait19","webhookId":"88f24009-c9fc-4004-9c01-72b0f0f6b58c"},{"parameters":{"operation":"create","base":{"__rl":true,"value":"={{ $node[\"masterVar\"].json['airtableBase'] }}","mode":"id"},"table":{"__rl":true,"value":"={{ $node[\"masterVar\"].json['Redes Sociales'] }}","mode":"id"},"columns":{"mappingMode":"defineBelow","value":{"Caption":"={{ $('varPostCarrusel0').item.json['Caption de Instagram'] }}","Frase Clave":"={{ $('varPostCarrusel0').item.json['Frase Clave'].join(\", \").replace(/\\n/g, \" \")  }}","Tipo":"Carrusel","Red Social":"Instagram","Color":"={{ $('varPostCarrusel0').item.json.Color }}","Fecha publicación":"={{ $now.toISO() }}"},"matchingColumns":[],"schema":[{"id":"Caption","displayName":"Caption","required":false,"defaultMatch":false,"canBeUsedToMatch":true,"display":true,"type":"string","readOnly":false,"removed":false},{"id":"Frase Clave","displayName":"Frase Clave","required":false,"defaultMatch":false,"canBeUsedToMatch":true,"display":true,"type":"string","readOnly":false,"removed":false},{"id":"Tipo","displayName":"Tipo","required":false,"defaultMatch":false,"canBeUsedToMatch":true,"display":true,"type":"options","options":[{"name":"Imagen","value":"Imagen"},{"name":"Carrusel","value":"Carrusel"},{"name":"Video","value":"Video"}],"readOnly":false,"removed":false},{"id":"Red Social","displayName":"Red Social","required":false,"defaultMatch":false,"canBeUsedToMatch":true,"display":true,"type":"options","options":[{"name":"Facebook","value":"Facebook"},{"name":"Instagram","value":"Instagram"}],"readOnly":false,"removed":false},{"id":"Color","displayName":"Color","required":false,"defaultMatch":false,"canBeUsedToMatch":true,"display":true,"type":"string","readOnly":false,"removed":false},{"id":"Fecha publicación","displayName":"Fecha publicación","required":false,"defaultMatch":false,"canBeUsedToMatch":true,"display":true,"type":"dateTime","readOnly":false,"removed":false}],"attemptToConvertTypes":false,"convertFieldsToString":false},"options":{}},"type":"n8n-nodes-base.airtable","typeVersion":2.1,"position":[3264,1232],"id":"a4c8fc50-6c50-4eda-b28b-36e8a69e1ac1","name":"Create a record7"},{"parameters":{"jsCode":"// Objetivo: devolver { mediaUrls: \"U1, U2, U3\" } sin repetir y en orden correcto.\n\n// 1) Extrae URL y posible índice\nconst pairs = items\n  .map((it, i) => {\n    const j = it.json ?? {};\n    const url =\n      (typeof j.url === 'string' && j.url.trim())\n        ? j.url.trim()\n        : (typeof j?.mediaUploadResponse?.url === 'string'\n            ? j.mediaUploadResponse.url.trim()\n            : null);\n\n    if (!url) return null;\n\n    const idx = Number.isFinite(Number(j.indice)) ? Number(j.indice) : i;\n    return { idx, url };\n  })\n  .filter(Boolean);\n\n// 2) Ordena por indice si hay índices personalizados\nconst hasCustomIndex = pairs.some((p, i) => p.idx !== i);\nif (hasCustomIndex) {\n  pairs.sort((a, b) => a.idx - b.idx);\n}\n\n// 3) Dedup: elimina repetidos preservando la primera aparición\nconst seen = new Set();\nconst orderedUnique = [];\nfor (const { url } of pairs) {\n  if (!seen.has(url)) {\n    seen.add(url);\n    orderedUnique.push(url);\n  }\n}\n\n// 4) Une con coma + espacio (formato solicitado)\nconst csv = orderedUnique.join(', ');\n\n// 5) Valida y retorna siempre un objeto\nif (!csv) {\n  throw new Error('No se encontraron mediaUrls válidas en la entrada.');\n}\n\nreturn [{ json: { mediaUrlsCarrusel: csv } }];\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[2144,1232],"id":"9a09c21e-8e3e-4bea-9970-745014f56a34","name":"mediaUrlsCarrusel1"},{"parameters":{},"type":"n8n-nodes-base.merge","typeVersion":3.2,"position":[3488,1184],"id":"f10afdd9-40cb-46c0-9174-a6c9291b9d88","name":"Merge6"},{"parameters":{"chatId":"1019249029","text":"=✅​  {{ $node[\"masterVar\"].json['Cliente'] }} ✅\nSe realizó el posteo correctamente","additionalFields":{"appendAttribution":false,"parse_mode":"HTML"}},"type":"n8n-nodes-base.telegram","typeVersion":1.2,"position":[2640,480],"id":"6e2514e2-8707-4c6a-a37c-b6dcb0a7e611","name":"✅​1","webhookId":"998ac10a-d45d-44cc-92ff-23adcbec09ee","executeOnce":true},{"parameters":{},"type":"n8n-nodes-base.merge","typeVersion":3.2,"position":[2464,480],"id":"d402eceb-2ec5-40d2-80c1-23f568ac809f","name":"Merge7"},{"parameters":{"amount":"={{ $json.numero }}","unit":"minutes"},"type":"n8n-nodes-base.wait","typeVersion":1.1,"position":[-608,768],"id":"c21f72fa-fca2-444c-9d21-4220e9588b99","name":"Wait","webhookId":"229e5a08-38b8-4070-90b3-d95a6c6ba905"},{"parameters":{"jsCode":"const numero = Math.floor(Math.random() * 45) + 1;\n\nreturn [\n  {\n    json: {\n      numero\n    }\n  }\n];"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[-816,768],"id":"760f5638-37ff-4bd8-ae9d-d453bfd6d597","name":"Code1"},{"parameters":{"assignments":{"assignments":[{"id":"65e4fb7b-f885-41b8-9232-8435caa54ea9","name":"Cliente","value":"Ameyal Inmobiliaria","type":"string"},{"id":"0bcc34a6-73fa-4691-bd4e-0a1f8fc4a02a","name":"airtableBase","value":"appb83b3VCKAonLjs","type":"string"},{"id":"68457664-8845-487a-8c77-ac212972b1a6","name":"Redes Sociales","value":"tblSHOlC917rApYNT","type":"string"},{"id":"d57d84c8-d526-45fe-8a92-d74598655559","name":"plantillaIMG","value":"qpm2c3pvtkrjz","type":"string"},{"id":"bc5799d2-dd3f-4caf-b76f-8b5b2ebdb1d7","name":"plantillaCarrucelTitulo","value":"xvjhrg4x4fihy","type":"string"},{"id":"384ae256-b521-4aac-addb-8ce4995bc95b","name":"plantillaCarruselCuerpo","value":"fz0iidmaxyycr","type":"string"},{"id":"dfa0db3b-54c4-4d64-9674-fb3064cd336a","name":"plantillaCarruselVideo","value":"ignas3vh5cxnp","type":"string"},{"id":"e3e9f354-3f3c-4cdb-8dde-1437dccae795","name":"Color1","value":"#512E88","type":"string"},{"id":"84d996d2-f399-4e98-8f66-747b00062691","name":"Color2","value":"#1391C2","type":"string"},{"id":"08bfdf7c-3ffd-451c-82ab-411dd8f9b303","name":"instagram","value":"15136","type":"string"},{"id":"aee51936-f5d7-4482-b16f-a2b6ee853b10","name":"facebook","value":"8833","type":"string"},{"id":"41274361-90f6-4b99-8552-492aee207794","name":"facebook_page","value":"727025147168558","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[-1040,1056],"id":"f06fb658-8960-4c59-ad31-f264b4dd0854","name":"masterVar"},{"parameters":{"promptType":"define","text":"=Genera una publicación educativa o de confianza para {{$node[\"masterVar\"].json['Cliente']}}, enfocada en atraer dueños de propiedades que desean vender o rentar.  \n\nEl contenido debe ser **claro, cercano y profesional**, transmitiendo **confianza y autoridad en el sector inmobiliario**.  \n\n➡️ Requisitos:  \n- Explica siempre un **beneficio práctico** para el propietario (ejemplo: cómo valorar su propiedad, cómo evitar riesgos, cómo acelerar la renta).  \n- Adopta un **tono consultivo y humano**, no de venta agresiva.  \n- Varía los ángulos en cada publicación (tips, errores comunes, pasos, beneficios).  \n- Siempre incluye un **CTA concreto** (ejemplo: agenda tu asesoría gratuita, solicita tu valuación, envía un mensaje).  ","options":{"systemMessage":"=Eres un Community Manager experto en marketing inmobiliario, especializado en atraer propietarios de inmuebles que desean vender o rentar.\n\n🎯 Objetivo  \nGenerar publicaciones educativas y de confianza que posicionen a la inmobiliaria como profesional, transparente y confiable.  \nEl contenido debe estar optimizado para **Instagram y Facebook**.\n\n📌 Formato de respuesta obligatorio (únicamente JSON válido, sin texto adicional):  \n{\n  \"Tipo\": \"Carrusel | Imagen | Video\",\n  \"Caption_Instagram\": \"Texto breve y dinámico con emojis, máximo 2 párrafos de hasta 220 caracteres cada uno, tono cercano y amigable, con CTA claro.\",\n  \"Caption_Facebook\": \"Texto más completo (3 a 5 párrafos), tono profesional e informativo, puede usar emojis con moderación, siempre con CTA claro al final.\",\n  \"Frase Clave\": [\n    \"Título principal\",\n    \"Frase subsecuente 1\",\n    \"Frase subsecuente 2\"\n  ],\n  \"Color\": \"#HEXCOLOR\",\n  \"Slides\": 5\n}\n\n🔧 Fuente de contexto:  \nPost Históricos → contiene los últimos 30 posts (ordenados del más reciente al más antiguo).  \nUsa esta información para:  \n- Evitar duplicar contenido: tanto Caption como Frase Clave deben diferir de los últimos posts.  \n\n⚙️ Reglas de generación:  \n1. **Color y Tipo**  \n   - Usa estrictamente los valores recibidos: `\"Tipo\": \"{{ $json.Tipo }}\"` y `\"Color\": \"{{ $json.Color }}\"`.  \n   - Nunca inventes nuevos valores.  \n\n2. **Imagen o Video**  \n   - `\"Frase Clave\"` debe contener solo **1 frase poderosa, breve e impactante** (como un slogan).  \n   - No incluyas la clave `\"Slides\"`.  \n\n3. **Carrusel**  \n   - `\"Frase Clave\"` debe contener entre 4 y 6 frases (la primera es el título principal).  \n   - Incluye siempre `\"Slides\"` con el número total de frases.  \n\n🔒 Nota: Responde únicamente en **JSON válido**. No devuelvas explicaciones, comentarios ni texto fuera de la estructura."}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":2.2,"position":[-368,1056],"id":"589713f6-a38d-4945-9196-6ec9043174d8","name":"AI Agent"},{"parameters":{"model":{"__rl":true,"value":"gpt-4","mode":"list","cachedResultName":"gpt-4"},"options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenAi","typeVersion":1.2,"position":[-368,1264],"id":"5912b92b-a069-40a7-ae07-d78edc5304d9","name":"OpenAI Chat Model"},{"parameters":{"jsCode":"return items.map(item => {\n  let raw = item.json.output;\n  if (typeof raw !== \"string\") {\n    return [{\n      json: {\n        error: true,\n        rawOutput: raw,\n        message: \"El campo 'output' no es un string válido.\"\n      }\n    }];\n  }\n\n  let parsed;\n\n  try {\n    // 1) Extraer bloque JSON más probable si hay texto adicional\n    const match = raw.match(/\\{[\\s\\S]*\\}/);\n    if (!match) {\n      return [{\n        json: {\n          error: true,\n          rawOutput: raw,\n          message: \"No se encontró un bloque JSON en la respuesta.\"\n        }\n      }];\n    }\n    let cleaned = match[0];\n\n    // 2) Eliminar caracteres de control invisibles\n    cleaned = cleaned.replace(/[\\u0000-\\u001F\\u007F]/g, \" \").trim();\n\n    // 3) Intentar parsear\n    parsed = JSON.parse(cleaned);\n\n  } catch (e) {\n    return [{\n      json: {\n        error: true,\n        rawOutput: raw,\n        message: \"No se pudo parsear el JSON: \" + e.message\n      }\n    }];\n  }\n\n  // 4) Normalizar claves\n  const norm = {};\n  for (const [k, v] of Object.entries(parsed)) {\n    const key = k.toLowerCase().replace(/\\s+/g, \"_\");\n    norm[key] = v;\n  }\n\n  // 5) Construir el objeto base\n  const result = {\n    Tipo: norm.tipo || \"\",\n    Caption_Instagram: norm.caption_instagram || \"\",\n    Caption_Facebook: norm.caption_facebook || \"\",\n    \"Frase Clave\": Array.isArray(norm.frase_clave)\n      ? norm.frase_clave\n      : norm.frase_clave\n      ? [String(norm.frase_clave)]\n      : [],\n    Color: norm.color || \"\" // no lo alteramos, se toma directo de masterVar\n  };\n\n  // 6) Slides para Carrusel\n  if (String(result.Tipo).toLowerCase() === \"carrusel\") {\n    let slidesCount = norm.slides || result[\"Frase Clave\"].length;\n    result.Slides = Math.max(2, Math.min(6, slidesCount));\n  }\n\n  return { json: result };\n});"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[-16,1056],"id":"51f582df-e3a2-4b9c-9d75-6d42c687af43","name":"Code in JavaScript"},{"parameters":{"rules":{"values":[{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"leftValue":"={{ $json.Tipo }}","rightValue":"Imagen","operator":{"type":"string","operation":"equals"},"id":"36aaf760-101c-4377-8a51-a6e49c314025"}],"combinator":"and"},"renameOutput":true,"outputKey":"Imagen"},{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"f9840fe7-de36-421e-95d7-016ccd082b80","leftValue":"={{ $json.Tipo }}","rightValue":"Carrusel","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}}],"combinator":"and"},"renameOutput":true,"outputKey":"Carrusel"},{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"0b618f49-015d-40e5-ad43-f8c138483757","leftValue":"={{ $json.Tipo }}","rightValue":"Video","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}}],"combinator":"and"},"renameOutput":true,"outputKey":"Video"}]},"options":{}},"type":"n8n-nodes-base.switch","typeVersion":3.2,"position":[208,1040],"id":"a47b9df2-4233-403c-9185-991ec9d27689","name":"Switch"},{"parameters":{"assignments":{"assignments":[{"id":"5c3d170c-badd-4a4d-ac00-a569d416fbe1","name":"Tipo","value":"={{ $json.Tipo }}","type":"string"},{"id":"8426ab61-e126-49c1-9e5f-b3809e707cf5","name":"CaptionIN","value":"={{ $json.Caption_Instagram }}","type":"string"},{"id":"d6e7198a-6f4a-46a4-8511-1b359672c0ab","name":"CaptionFB","value":"={{ $json.Caption_Facebook }}","type":"string"},{"id":"b950c017-40ac-430d-bf11-1480faeda43d","name":"Frase Clave","value":"={{ $json['Frase Clave'] }}","type":"array"},{"id":"cb8113ab-a67e-4060-adf3-13329b1d0b1f","name":"Color","value":"={{ $json.Color }}","type":"string"},{"id":"7f0b0a4b-479a-4408-83c9-75f52b6397af","name":"Plantilla","value":"={{ $node[\"masterVar\"].json['plantillaIMG'] }}","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[528,608],"id":"9eb9edd0-c527-48a0-b256-8665d52f1017","name":"varPostIMG"},{"parameters":{"resource":"image","prompt":"=Crea una imagen hiperrealista que sirva como fondo atractivo para un post de redes sociales del sector inmobiliario. \n\nDebe transmitir profesionalismo, confianza y aspiración (hogares modernos, arquitectura elegante, estilo limpio). \nNo incluyas texto ni logotipos en la imagen. \nEl diseño debe ser minimalista, con iluminación natural y espacio visual suficiente para superponer tipografías o elementos gráficos. \n\nLos captions a acompañar en redes sociales son:\n- Facebook: {{ $json.CaptionFB }}\n- Instagram: {{ $json.CaptionIN }}","options":{}},"type":"@n8n/n8n-nodes-langchain.openAi","typeVersion":1.8,"position":[720,608],"id":"5d8247e2-0f0f-4438-b185-00a921c4ddc2","name":"fondoIMG"},{"parameters":{},"type":"n8n-nodes-base.wait","typeVersion":1.1,"position":[944,608],"id":"9173be4b-8235-4a4b-b907-7ee0f1784262","name":"Wait1","webhookId":"c53862ef-4743-4bac-9cdb-69f4fb3a9265"},{"parameters":{"operation":"create","base":{"__rl":true,"value":"={{ $node[\"masterVar\"].json['airtableBase'] }}","mode":"id"},"table":{"__rl":true,"value":"={{ $node[\"masterVar\"].json['Redes Sociales'] }}","mode":"id"},"columns":{"mappingMode":"defineBelow","value":{"Caption":"={{ $('varPostIMG').item.json.CaptionIN }}","Frase Clave":"={{ $('varPostIMG').item.json['Frase Clave'][0] }}","Tipo":"={{ $('varPostIMG').item.json.Tipo }}","Red Social":"Instagram","Color":"={{ $('varPostIMG').item.json.Color }}","Fecha publicación":"={{ $now.toISO() }}"},"matchingColumns":[],"schema":[{"id":"Caption","displayName":"Caption","required":false,"defaultMatch":false,"canBeUsedToMatch":true,"display":true,"type":"string","readOnly":false,"removed":false},{"id":"Frase Clave","displayName":"Frase Clave","required":false,"defaultMatch":false,"canBeUsedToMatch":true,"display":true,"type":"string","readOnly":false,"removed":false},{"id":"Tipo","displayName":"Tipo","required":false,"defaultMatch":false,"canBeUsedToMatch":true,"display":true,"type":"options","options":[{"name":"Imagen","value":"Imagen"},{"name":"Carrusel","value":"Carrusel"},{"name":"Video","value":"Video"}],"readOnly":false,"removed":false},{"id":"Red Social","displayName":"Red Social","required":false,"defaultMatch":false,"canBeUsedToMatch":true,"display":true,"type":"options","options":[{"name":"Facebook","value":"Facebook"},{"name":"Instagram","value":"Instagram"}],"readOnly":false,"removed":false},{"id":"Color","displayName":"Color","required":false,"defaultMatch":false,"canBeUsedToMatch":true,"display":true,"type":"string","readOnly":false,"removed":false},{"id":"Fecha publicación","displayName":"Fecha publicación","required":false,"defaultMatch":false,"canBeUsedToMatch":true,"display":true,"type":"dateTime","readOnly":false,"removed":false}],"attemptToConvertTypes":false,"convertFieldsToString":false},"options":{}},"type":"n8n-nodes-base.airtable","typeVersion":2.1,"position":[2288,384],"id":"da58343c-d1ee-4d91-8328-a5cc155c421a","name":"CreateINPost"},{"parameters":{"operation":"create","base":{"__rl":true,"value":"={{ $node[\"masterVar\"].json['airtableBase'] }}","mode":"id"},"table":{"__rl":true,"value":"={{ $node[\"masterVar\"].json['Redes Sociales'] }}","mode":"id"},"columns":{"mappingMode":"defineBelow","value":{"Tipo":"={{ $('varPostIMG').item.json.Tipo }}","Caption":"={{ $('varPostIMG').item.json.CaptionFB }}","Frase Clave":"={{ $('varPostIMG').item.json['Frase Clave'].join(', ') }}","Red Social":"Facebook","Fecha publicación":"={{ $now.toISO() }}","Color":"={{ $('varPostIMG').item.json.Color }}"},"matchingColumns":[],"schema":[{"id":"Caption","displayName":"Caption","required":false,"defaultMatch":false,"canBeUsedToMatch":true,"display":true,"type":"string","readOnly":false,"removed":false},{"id":"Frase Clave","displayName":"Frase Clave","required":false,"defaultMatch":false,"canBeUsedToMatch":true,"display":true,"type":"string","readOnly":false,"removed":false},{"id":"Tipo","displayName":"Tipo","required":false,"defaultMatch":false,"canBeUsedToMatch":true,"display":true,"type":"options","options":[{"name":"Imagen","value":"Imagen"},{"name":"Carrusel","value":"Carrusel"},{"name":"Video","value":"Video"}],"readOnly":false,"removed":false},{"id":"Red Social","displayName":"Red Social","required":false,"defaultMatch":false,"canBeUsedToMatch":true,"display":true,"type":"options","options":[{"name":"Facebook","value":"Facebook"},{"name":"Instagram","value":"Instagram"}],"readOnly":false,"removed":false},{"id":"Color","displayName":"Color","required":false,"defaultMatch":false,"canBeUsedToMatch":true,"display":true,"type":"string","readOnly":false,"removed":false},{"id":"Fecha publicación","displayName":"Fecha publicación","required":false,"defaultMatch":false,"canBeUsedToMatch":true,"display":true,"type":"dateTime","readOnly":false,"removed":false}],"attemptToConvertTypes":false,"convertFieldsToString":false},"options":{}},"type":"n8n-nodes-base.airtable","typeVersion":2.1,"position":[2288,544],"id":"b51f091a-b6bc-4056-9e22-4f541b127cce","name":"CreateFBPost"},{"parameters":{"resource":"image","prompt":"=Crea una imagen hiperrealista que sirva como fondo atractivo para un post de redes sociales del sector inmobiliario. \n\nDebe transmitir profesionalismo, confianza y aspiración (hogares modernos, arquitectura elegante, estilo limpio). \nNo incluyas texto ni logotipos en la imagen. \nEl diseño debe ser minimalista, con iluminación natural y espacio visual suficiente para superponer tipografías o elementos gráficos. \n\nLos captions a acompañar en redes sociales son:\n- Facebook: {{ $json.CaptionFB }}\n- Instagram: {{ $json.CaptionIN }}","options":{}},"type":"@n8n/n8n-nodes-langchain.openAi","typeVersion":1.8,"position":[704,1232],"id":"1e70e1e1-f3a9-4293-af49-18cef1281974","name":"fondoIMG1"},{"parameters":{},"type":"n8n-nodes-base.wait","typeVersion":1.1,"position":[896,1232],"id":"34f68225-6b46-4a9c-806c-b5e810c259c0","name":"Wait2","webhookId":"c53862ef-4743-4bac-9cdb-69f4fb3a9265"},{"parameters":{"template_id":{"__rl":true,"value":"={{ $node[\"varPostCarrusel3\"].json['PlantillaTitulo'] }}","mode":"id"},"layers":{"layerItems":[{"layerId":"img|picture","property":"imageBinary","imageBinaryValue":"data"},{"layerId":"title|text","property":"text","textValue":"={{ $node[\"varPostCarrusel3\"].json['carruselTitulo'] }}"},{"layerId":"Marco|rectangle","property":"background_color","background_colorValue":"={{ $node[\"varPostCarrusel3\"].json['Color'] }}"},{"layerId":"bg|rectangle","property":"background_color","background_colorValue":"={{ $node[\"varPostCarrusel3\"].json['Color'] }}"}]},"additionalFields":{}},"type":"n8n-nodes-placid.placid","typeVersion":1,"position":[1088,1232],"id":"eead2d73-bebc-42d2-8e3f-c5b7a1a967ea","name":"PortadaCarrusel","retryOnFail":true,"waitBetweenTries":5000,"onError":"continueErrorOutput"},{"parameters":{"jsCode":"const data = items[0]?.json ?? {};\n\n// Validamos que existan FraseClave y al menos un elemento más allá del primero\nconst frases = Array.isArray(data.FraseClave) ? data.FraseClave.slice(1) : [];\n\nif (!frases.length) {\n  throw new Error('No hay frases clave suficientes después de eliminar la primera.');\n}\n\nconst color = data.Color ?? '#000000';\nconst plantilla = data.PlantillaCuerpo ?? '';\n\nreturn frases.map((texto, i) => {\n  return {\n    json: {\n      indice: i + 1,\n      texto: texto.trim(),\n      color,\n      plantilla\n    }\n  };\n});\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[752,1520],"id":"f6ecb9d7-9662-473e-89b6-ed242be55929","name":"Code in JavaScript1"},{"parameters":{"assignments":{"assignments":[{"id":"b950c017-40ac-430d-bf11-1480faeda43d","name":"FraseClave","value":"={{ $json['Frase Clave'] }}","type":"array"},{"id":"cb8113ab-a67e-4060-adf3-13329b1d0b1f","name":"Color","value":"={{ $json.Color }}","type":"string"},{"id":"07790429-9b37-4ec8-9853-22e8db58bfac","name":"PlantillaCuerpo","value":"={{ $node[\"masterVar\"].json['plantillaCarruselCuerpo'] }}","type":"string"},{"id":"e64d066f-2a03-47ca-a30c-6e89d812f3c8","name":"Slides","value":"={{ $json.Slides }}","type":"number"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[544,1520],"id":"9ef6d025-d3ca-4800-9029-ff4e49be621d","name":"varPostCarruselCuerpo"},{"parameters":{"template_id":{"__rl":true,"value":"={{ $json.plantilla }}","mode":"id"},"layers":{"layerItems":[{"layerId":"title|text","property":"text","textValue":"={{ $json.texto }}"},{"layerId":"Marco|rectangle","property":"background_color","background_colorValue":"={{ $json.color }}"}]},"additionalFields":{}},"type":"n8n-nodes-placid.placid","typeVersion":1,"position":[1296,1536],"id":"16068b73-5ba2-4adf-8b11-11056257d913","name":"slides","retryOnFail":true,"waitBetweenTries":5000,"onError":"continueErrorOutput"},{"parameters":{"assignments":{"assignments":[{"id":"8426ab61-e126-49c1-9e5f-b3809e707cf5","name":"CaptionIN","value":"={{ $json.Caption_Instagram }}","type":"string"},{"id":"d6e7198a-6f4a-46a4-8511-1b359672c0ab","name":"CaptionFB","value":"={{ $json.Caption_Facebook }}","type":"string"},{"id":"210672f3-b1c1-4804-bb6c-ac2a122ca272","name":"Color","value":"={{ $json.Color }}","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[528,1056],"id":"7d16c5df-b779-4c06-899b-4ecd28158eed","name":"varPostCarrusel2"},{"parameters":{"assignments":{"assignments":[{"id":"0ac59ead-fc8d-4070-b52b-8759a768025b","name":"carruselTitulo","value":"={{ $json['Frase Clave'][0] }}","type":"string"},{"id":"cb8113ab-a67e-4060-adf3-13329b1d0b1f","name":"Color","value":"={{ $json.Color }}","type":"string"},{"id":"7f0b0a4b-479a-4408-83c9-75f52b6397af","name":"PlantillaTitulo","value":"={{ $node[\"masterVar\"].json['plantillaCarrucelTitulo'] }}","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[528,1232],"id":"53f7f14c-0c5a-4811-9602-cdf1ff8f14e1","name":"varPostCarrusel3"},{"parameters":{"assignments":{"assignments":[{"id":"88ab81c9-4cbf-4e4c-9563-f5ec4f58ea0e","name":"Caption de Facebook","value":"={{ $json.CaptionFB }}","type":"string"},{"id":"5107acff-164b-4417-99cc-407faae0a4a9","name":"Caption de Instagram","value":"={{ $json.CaptionIN }}","type":"string"},{"id":"bfc1c005-76b5-4fa5-82e6-0d0012ec0201","name":"mediaUrlsCarrusel","value":"={{ $items(\"mediaUrlsCarrusel1\", 0)[0].json.mediaUrlsCarrusel }}","type":"string"},{"id":"f178791f-9d08-4867-b816-73d5341c3900","name":"Frase Clave","value":"={{ $('Switch').item.json['Frase Clave'] }}","type":"array"},{"id":"9b34919c-5c19-44b1-962e-77f212d7dea9","name":"Color","value":"={{ $('varPostCarrusel2').item.json.Color }}","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[2544,1072],"id":"d49f62ec-88d3-4331-bbd8-c2410d9ac935","name":"varPostCarrusel0"},{"parameters":{"content":"## ACTUALIZAR\nPROMPT","height":272,"width":224},"type":"n8n-nodes-base.stickyNote","position":[672,512],"typeVersion":1,"id":"25a67e9f-8bf7-4fc9-937b-284ab6cf4f5d","name":"Sticky Note"},{"parameters":{"content":"## ACTUALIZAR\nPROMPT","height":272,"width":224},"type":"n8n-nodes-base.stickyNote","position":[656,1136],"typeVersion":1,"id":"959402ff-7a2d-4b75-84d5-450feae96d1a","name":"Sticky Note2"},{"parameters":{"content":"## ACTUALIZAR\nPROMPT","height":432,"width":352},"type":"n8n-nodes-base.stickyNote","position":[-416,976],"typeVersion":1,"id":"a34bfed0-1526-4e16-aacf-cbd5b8f4ace3","name":"Sticky Note6"},{"parameters":{"descriptionType":"manual","toolDescription":"Utiliza esta base como memoria, para que los post no lleguen a ser repetitivos en cuanto al contenido del Caption y Frase Clave, y rotes elementos clave como\n- Tipo\n- Color","resource":"base","operation":"getSchema","base":{"__rl":true,"value":"appb83b3VCKAonLjs","mode":"list","cachedResultName":"Ameyal","cachedResultUrl":"https://airtable.com/appb83b3VCKAonLjs"}},"type":"n8n-nodes-base.airtableTool","typeVersion":2.1,"position":[-208,1264],"id":"d05ca2a9-53fd-4372-a6fd-24a92c4dfb9a","name":"Post Historicos"},{"parameters":{"assignments":{"assignments":[{"id":"5c3d170c-badd-4a4d-ac00-a569d416fbe1","name":"Tipo","value":"={{ $json.Tipo }}","type":"string"},{"id":"8426ab61-e126-49c1-9e5f-b3809e707cf5","name":"CaptionIN","value":"={{ $json.Caption_Instagram }}","type":"string"},{"id":"d6e7198a-6f4a-46a4-8511-1b359672c0ab","name":"CaptionFB","value":"={{ $json.Caption_Facebook }}","type":"string"},{"id":"b950c017-40ac-430d-bf11-1480faeda43d","name":"Frase Clave","value":"={{ $json['Frase Clave'] }}","type":"array"},{"id":"cb8113ab-a67e-4060-adf3-13329b1d0b1f","name":"Color","value":"={{ $json.Color }}","type":"string"},{"id":"7f0b0a4b-479a-4408-83c9-75f52b6397af","name":"Plantilla","value":"={{ $node[\"masterVar\"].json['plantillaCarruselVideo'] }}","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[544,2176],"id":"c3b7fe77-3da0-4140-ad7a-9db70c3687b7","name":"varPostVideo"},{"parameters":{},"type":"n8n-nodes-base.wait","typeVersion":1.1,"position":[1648,1968],"id":"83d1fc92-9184-4aaa-bbe3-e542342835fa","name":"Wait14","webhookId":"4a03badc-00e4-403d-92f5-173d0ec512cd"},{"parameters":{"chatId":"1019249029","text":"=⚠️​ {{ $(\"masterVar\").item.json.Cliente }} ⚠️​\nHubo un error al querer hacer la publicación de hoy publicar","additionalFields":{"appendAttribution":false,"parse_mode":"HTML"}},"type":"n8n-nodes-base.telegram","typeVersion":1.2,"position":[1856,2528],"id":"58a4c3b7-d07e-4ecd-a128-7e182e010325","name":"⚠️​","webhookId":"c65b4315-f541-44ce-b6e2-f908447ce407","executeOnce":true},{"parameters":{},"type":"n8n-nodes-base.noOp","typeVersion":1,"position":[2528,2048],"id":"f30e2afe-7fee-4357-9b3d-896f4840932d","name":"No Operation, do nothing"},{"parameters":{"content":"## ACTUALIZAR\nID de Red Social","height":592,"width":224},"type":"n8n-nodes-base.stickyNote","position":[1376,1856],"typeVersion":1,"id":"369e3da1-3b2a-4100-8cca-0bce0b638ae7","name":"Sticky Note5"},{"parameters":{"amount":10},"type":"n8n-nodes-base.wait","typeVersion":1.1,"position":[976,2160],"id":"9b3d984a-4554-4d57-b47d-70c3ca6cfdaa","name":"Wait20","webhookId":"29a5f910-875a-4161-9765-734fe0240879"},{"parameters":{},"type":"n8n-nodes-base.wait","typeVersion":1.1,"position":[1648,2112],"id":"5e9429b0-219a-4d80-b492-d26061bea33f","name":"Wait21","webhookId":"e94a3d72-2d11-417d-b5cb-837230d05209"},{"parameters":{"chatId":"1019249029","text":"=✅​ {{ $node[\"masterVar\"].json['Cliente'] }} ✅​\nSe realizó el posteo correctamente","additionalFields":{"appendAttribution":false,"parse_mode":"HTML"}},"type":"n8n-nodes-base.telegram","typeVersion":1.2,"position":[2208,2048],"id":"595aebe9-fd3c-4cc7-8ed8-2a70dcdf9951","name":"✅​","webhookId":"998ac10a-d45d-44cc-92ff-23adcbec09ee","executeOnce":true},{"parameters":{},"type":"n8n-nodes-base.merge","typeVersion":3.2,"position":[2032,2048],"id":"1a740fb3-d34c-4784-b1c2-a354a2478317","name":"Merge"},{"parameters":{"operation":"create","base":{"__rl":true,"value":"={{ $node[\"masterVar\"].json['airtableBase'] }}","mode":"id"},"table":{"__rl":true,"value":"={{ $node[\"masterVar\"].json['Redes Sociales'] }}","mode":"id"},"columns":{"mappingMode":"defineBelow","value":{"Tipo":"={{ $('varPostVideo').item.json.Tipo }}","Caption":"={{ $('varPostVideo').item.json.CaptionIN }}","Frase Clave":"={{ $('varPostVideo').item.json['Frase Clave'].join(', ') }}","Red Social":"Instagram","Fecha publicación":"={{ $now.toISO() }}","Color":"={{ $('varPostVideo').item.json.Color }}"},"matchingColumns":[],"schema":[{"id":"Caption","displayName":"Caption","required":false,"defaultMatch":false,"canBeUsedToMatch":true,"display":true,"type":"string","readOnly":false,"removed":false},{"id":"Frase Clave","displayName":"Frase Clave","required":false,"defaultMatch":false,"canBeUsedToMatch":true,"display":true,"type":"string","readOnly":false,"removed":false},{"id":"Tipo","displayName":"Tipo","required":false,"defaultMatch":false,"canBeUsedToMatch":true,"display":true,"type":"options","options":[{"name":"Imagen","value":"Imagen"},{"name":"Carrusel","value":"Carrusel"},{"name":"Video","value":"Video"}],"readOnly":false,"removed":false},{"id":"Red Social","displayName":"Red Social","required":false,"defaultMatch":false,"canBeUsedToMatch":true,"display":true,"type":"options","options":[{"name":"Facebook","value":"Facebook"},{"name":"Instagram","value":"Instagram"}],"readOnly":false,"removed":false},{"id":"Color","displayName":"Color","required":false,"defaultMatch":false,"canBeUsedToMatch":true,"display":true,"type":"string","readOnly":false,"removed":false},{"id":"Fecha publicación","displayName":"Fecha publicación","required":false,"defaultMatch":false,"canBeUsedToMatch":true,"display":true,"type":"dateTime","readOnly":false,"removed":false}],"attemptToConvertTypes":false,"convertFieldsToString":false},"options":{}},"type":"n8n-nodes-base.airtable","typeVersion":2.1,"position":[1856,1968],"id":"efc04cf4-78e8-4654-995a-d114bd835515","name":"CreateINPost1"},{"parameters":{"operation":"create","base":{"__rl":true,"value":"={{ $node[\"masterVar\"].json['airtableBase'] }}","mode":"id"},"table":{"__rl":true,"value":"={{ $node[\"masterVar\"].json['Redes Sociales'] }}","mode":"id"},"columns":{"mappingMode":"defineBelow","value":{"Tipo":"={{ $('varPostVideo').item.json.Tipo }}","Caption":"={{ $('varPostVideo').item.json.CaptionFB }}","Frase Clave":"={{ $('varPostVideo').item.json['Frase Clave'][0] }}","Red Social":"Facebook","Color":"={{ $('varPostVideo').item.json.Color }}","Fecha publicación":"={{ $now.toISO() }}"},"matchingColumns":[],"schema":[{"id":"Caption","displayName":"Caption","required":false,"defaultMatch":false,"canBeUsedToMatch":true,"display":true,"type":"string","readOnly":false,"removed":false},{"id":"Frase Clave","displayName":"Frase Clave","required":false,"defaultMatch":false,"canBeUsedToMatch":true,"display":true,"type":"string","readOnly":false,"removed":false},{"id":"Tipo","displayName":"Tipo","required":false,"defaultMatch":false,"canBeUsedToMatch":true,"display":true,"type":"options","options":[{"name":"Imagen","value":"Imagen"},{"name":"Carrusel","value":"Carrusel"},{"name":"Video","value":"Video"}],"readOnly":false,"removed":false},{"id":"Red Social","displayName":"Red Social","required":false,"defaultMatch":false,"canBeUsedToMatch":true,"display":true,"type":"options","options":[{"name":"Facebook","value":"Facebook"},{"name":"Instagram","value":"Instagram"}],"readOnly":false,"removed":false},{"id":"Color","displayName":"Color","required":false,"defaultMatch":false,"canBeUsedToMatch":true,"display":true,"type":"string","readOnly":false,"removed":false},{"id":"Fecha publicación","displayName":"Fecha publicación","required":false,"defaultMatch":false,"canBeUsedToMatch":true,"display":true,"type":"dateTime","readOnly":false,"removed":false}],"attemptToConvertTypes":false,"convertFieldsToString":false},"options":{}},"type":"n8n-nodes-base.airtable","typeVersion":2.1,"position":[1856,2112],"id":"eb60ecd8-d2e0-4caa-b982-e1ef17c4182a","name":"CreateFBPost1"},{"parameters":{"resource":"video","template_id":{"__rl":true,"value":"={{ $json.Plantilla }}","mode":"id","__regex":"^(.*)$"},"audioSettings":{},"layers":{"layerItems":[{"layerId":"quote|text","property":"text","textValue":"={{ $json['Frase Clave'][0] }}"},{"layerId":"Fondo|rectangle","property":"background_color","background_colorValue":"={{ $json.Color }}"}]},"additionalFields":{}},"type":"n8n-nodes-placid.placid","typeVersion":1,"position":[752,2176],"id":"23c4a7ab-db91-4a33-9403-60d99fe88013","name":"Create a video from a template","retryOnFail":true,"waitBetweenTries":5000,"onError":"continueErrorOutput"},{"parameters":{"operation":"search","base":{"__rl":true,"value":"={{ $json.airtableBase }}","mode":"id"},"table":{"__rl":true,"value":"={{ $json['Redes Sociales'] }}","mode":"id"},"options":{}},"type":"n8n-nodes-base.airtable","typeVersion":2.1,"position":[-400,176],"id":"80522a0d-f858-4839-81bc-97efafa39cba","name":"Search records"},{"parameters":{"assignments":{"assignments":[{"id":"65e4fb7b-f885-41b8-9232-8435caa54ea9","name":"Cliente","value":"Ameyal Inmobiliaria","type":"string"},{"id":"0bcc34a6-73fa-4691-bd4e-0a1f8fc4a02a","name":"airtableBase","value":"appb83b3VCKAonLjs","type":"string"},{"id":"68457664-8845-487a-8c77-ac212972b1a6","name":"Redes Sociales","value":"tblSHOlC917rApYNT","type":"string"},{"id":"d57d84c8-d526-45fe-8a92-d74598655559","name":"plantillaIMG","value":"qpm2c3pvtkrjz","type":"string"},{"id":"bc5799d2-dd3f-4caf-b76f-8b5b2ebdb1d7","name":"plantillaCarrucelTitulo","value":"xvjhrg4x4fihy","type":"string"},{"id":"384ae256-b521-4aac-addb-8ce4995bc95b","name":"plantillaCarruselCuerpo","value":"fz0iidmaxyycr","type":"string"},{"id":"dfa0db3b-54c4-4d64-9674-fb3064cd336a","name":"plantillaCarruselVideo","value":"ignas3vh5cxnp","type":"string"},{"id":"e3e9f354-3f3c-4cdb-8dde-1437dccae795","name":"Color1","value":"#3C53CC","type":"string"},{"id":"84d996d2-f399-4e98-8f66-747b00062691","name":"Color2","value":"#C850C0","type":"string"},{"id":"08bfdf7c-3ffd-451c-82ab-411dd8f9b303","name":"instagram","value":"14397","type":"string"},{"id":"aee51936-f5d7-4482-b16f-a2b6ee853b10","name":"facebook","value":"8833","type":"string"},{"id":"41274361-90f6-4b99-8552-492aee207794","name":"facebook_page","value":"718303238043901","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[-560,176],"id":"dbc051c1-b804-44e3-97d9-a18db216df1d","name":"masterVar1"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"026ae6b8-07c2-4ba6-b482-7f2963209d32","leftValue":"={{ $items().length }}","rightValue":30,"operator":{"type":"number","operation":"gt"}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[-192,176],"id":"01191143-dfd7-4476-9dec-e029f7f43f0e","name":"If"},{"parameters":{},"type":"n8n-nodes-base.noOp","typeVersion":1,"position":[704,192],"id":"738b889b-c7db-4399-8351-a6a218707781","name":"No Operation, do nothing1"},{"parameters":{"operation":"deleteRecord","base":{"__rl":true,"value":"={{ $node[\"masterVar1\"].json['airtableBase'] }}","mode":"id"},"table":{"__rl":true,"value":"={{ $node[\"masterVar1\"].json['Redes Sociales'] }}","mode":"id"},"id":"={{ $json.id }}"},"type":"n8n-nodes-base.airtable","typeVersion":2.1,"position":[496,16],"id":"db1f0a74-cf36-4a1f-892f-88b1a5c5716e","name":"Delete a record"},{"parameters":{"jsCode":"// Máximo permitido\nconst LIMIT = 30;\n\n// Ordenar todos los items por fecha (más antiguos primero)\nconst sorted = items.sort((a, b) => {\n  return new Date(a.json.createdTime) - new Date(b.json.createdTime);\n});\n\n// Calcular cuántos sobran\nconst extraCount = items.length > LIMIT ? items.length - LIMIT : 0;\n\n// Seleccionar los más antiguos (los que sobran)\nconst extras = sorted.slice(0, extraCount);\n\n// Devolver solo los IDs\nreturn extras.map(e => {\n  return {\n    json: {\n      id: e.json.id,\n      createdTime: e.json.createdTime\n    }\n  };\n});\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[0,0],"id":"a750f062-8d5d-485e-9892-7cf7048d7335","name":"Code in JavaScript2"},{"parameters":{"batchSize":2,"options":{}},"type":"n8n-nodes-base.splitInBatches","typeVersion":3,"position":[224,0],"id":"9630f950-fcba-4ff4-b523-ba4e716c2b03","name":"Loop Over Items"},{"parameters":{},"type":"n8n-nodes-base.manualTrigger","typeVersion":1,"position":[-1280,1056],"id":"2ee0af0a-3d15-4c3b-a100-ca61cfaa2e90","name":"When clicking ‘Execute workflow’"},{"parameters":{"operation":"search","base":{"__rl":true,"value":"={{ $json.airtableBase }}","mode":"id"},"table":{"__rl":true,"value":"={{ $json['Redes Sociales'] }}","mode":"id"},"options":{}},"type":"n8n-nodes-base.airtable","typeVersion":2.1,"position":[-816,1056],"id":"4e78e0d0-12c9-4347-bd96-6301c14e2982","name":"Search records1"},{"parameters":{"jsCode":"// Leer los colores desde masterVar sin conectarlo directamente\nconst color1 = $node[\"masterVar\"].json[\"Color1\"];\nconst color2 = $node[\"masterVar\"].json[\"Color2\"];\n\nif (!color1 || !color2) {\n  throw new Error(\"Las variables Color1 y Color2 no existen en el nodo masterVar\");\n}\n\n// Los items que entran provienen de Search Records1 (posts históricos)\nconst sorted = items.sort((a, b) => new Date(b.json.createdTime) - new Date(a.json.createdTime));\n\n// Últimos 10 tipos\nconst history = sorted.slice(0, 10).map(e => e.json.Tipo);\n\n// Conteo de cada tipo\nconst counts = {\n  Video: history.filter(t => t === \"Video\").length,\n  Imagen: history.filter(t => t === \"Imagen\").length,\n  Carrusel: history.filter(t => t === \"Carrusel\").length,\n};\n\n// Pesos base (más balanceados para que Video salga más seguido)\nlet weights = { Video: 0.33, Imagen: 0.33, Carrusel: 0.34 };\n\n// Ajuste dinámico si un tipo domina demasiado\nconst limit = 4; // más estricto que antes\nfor (let tipo of [\"Video\", \"Imagen\", \"Carrusel\"]) {\n  if (counts[tipo] >= limit) {\n    weights[tipo] = 0.1;\n    const others = Object.keys(weights).filter(t => t !== tipo);\n    const extra = (1 - (weights.Video + weights.Imagen + weights.Carrusel)) / others.length;\n    for (let o of others) weights[o] += extra;\n  }\n}\n\nfunction weightedChoice(weights) {\n  const r = Math.random();\n  if (r < weights.Video) return \"Video\";\n  if (r < weights.Video + weights.Imagen) return \"Imagen\";\n  return \"Carrusel\";\n}\n\nlet nextType = weightedChoice(weights);\n\n// Evitar más de 3 iguales seguidos\nconst last3 = history.slice(0, 3);\nif (last3.length === 3 && last3.every(t => t === nextType)) {\n  const alternatives = [\"Video\", \"Imagen\", \"Carrusel\"].filter(t => t !== nextType);\n  nextType = alternatives[Math.floor(Math.random() * alternatives.length)];\n}\n\n// Alternancia de colores\nconst lastColor = sorted[0]?.json.Color || null;\nlet nextColor = Math.random() < 0.5 ? color1 : color2;\nif (lastColor && nextColor === lastColor) {\n  nextColor = (lastColor === color1) ? color2 : color1;\n}\n\n// Devolver solo un resultado global\nreturn [\n  {\n    json: {\n      Tipo: nextType,\n      Color: nextColor\n    }\n  }\n];"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[-560,1056],"id":"94bd1d9c-f194-43b1-be1b-d3b54cccaf62","name":"variablesDinamicas","executeOnce":true},{"parameters":{"content":"## ACTUALIZAR\nVar","height":272,"width":224},"type":"n8n-nodes-base.stickyNote","position":[-1088,976],"typeVersion":1,"id":"1f93cef9-7a5a-42a3-b379-7f83fad20606","name":"Sticky Note3"},{"parameters":{"resource":"media","mediaUrl":"={{ $json.image_url }}"},"type":"@blotato/n8n-nodes-blotato.blotato","typeVersion":2,"position":[1552,592],"id":"08839074-3142-4c17-9a29-1894de5befc8","name":"Upload media","retryOnFail":true,"onError":"continueErrorOutput"},{"parameters":{"resource":"media","mediaUrl":"={{ $json.img }}"},"type":"@blotato/n8n-nodes-blotato.blotato","typeVersion":2,"position":[2128,1408],"id":"6e407449-8766-4445-8102-361797342bb7","name":"Upload media1","retryOnFail":true,"onError":"continueErrorOutput"},{"parameters":{"platform":"facebook","accountId":{"__rl":true,"value":"={{ $node[\"masterVar\"].json['facebook'] }}","mode":"id"},"postContentText":"={{ $json['Caption de Facebook'] }}","postContentMediaUrls":"={{ $json.mediaUrlsCarrusel }}","facebookPageId":{"__rl":true,"value":"={{ $node[\"masterVar\"].json['facebook_page'] }}","mode":"id"},"options":{}},"type":"@blotato/n8n-nodes-blotato.blotato","typeVersion":2,"position":[2768,1072],"id":"7ca34b91-2b9c-4bfa-8fbe-8bc14f973599","name":"FacebookCarrusel","retryOnFail":true,"onError":"continueErrorOutput"},{"parameters":{"resource":"media","mediaUrl":"={{ $json.video_url }}"},"type":"@blotato/n8n-nodes-blotato.blotato","typeVersion":2,"position":[1136,2160],"id":"100b91d6-c3cb-414a-b6e0-dc84a13ad6fc","name":"Upload media2","retryOnFail":true,"onError":"continueErrorOutput"},{"parameters":{"platform":"facebook","accountId":{"__rl":true,"value":"={{ $node[\"masterVar\"].json['facebook'] }}","mode":"id"},"postContentText":"={{ $('varPostVideo').item.json.CaptionFB }}","postContentMediaUrls":"={{ $json.url }}","facebookPageId":{"__rl":true,"value":"={{ $node[\"masterVar\"].json['facebook_page'] }}","mode":"id"},"options":{"facebookMediaType":"reel"}},"type":"@blotato/n8n-nodes-blotato.blotato","typeVersion":2,"position":[1424,1984],"id":"2b53c9f5-7bf7-4168-9709-40b9ab4cc41f","name":"FacebookReal","retryOnFail":true,"onError":"continueErrorOutput"},{"parameters":{"accountId":{"__rl":true,"value":"={{ $node[\"masterVar\"].json['instagram'] }}","mode":"id"},"postContentText":"={{ $(\"varPostVideo\").item.json.CaptionIN }}","postContentMediaUrls":"={{ $json.url }}","options":{"instagramMediaType":"reel"}},"type":"@blotato/n8n-nodes-blotato.blotato","typeVersion":2,"position":[1424,2128],"id":"088b37e3-b006-44af-97eb-3a3fe069048d","name":"InstagramReal","retryOnFail":true,"onError":"continueErrorOutput"},{"parameters":{"accountId":{"__rl":true,"value":"={{ $node[\"masterVar\"].json['instagram'] }}","mode":"id"},"postContentText":"={{ $(\"varPostVideo\").item.json.CaptionIN }}","postContentMediaUrls":"={{ $json.url }}","options":{"instagramMediaType":"story"}},"type":"@blotato/n8n-nodes-blotato.blotato","typeVersion":2,"position":[1424,2288],"id":"1ad80d1d-52c2-4c88-a269-d332d1475a58","name":"InstagramStory","retryOnFail":true,"onError":"continueErrorOutput"},{"parameters":{"accountId":{"__rl":true,"value":"={{ $node[\"masterVar\"].json['instagram'] }}","mode":"id"},"postContentText":"={{ $json['Caption de Instagram'] }}","postContentMediaUrls":"={{ $json.mediaUrlsCarrusel }}","options":{}},"type":"@blotato/n8n-nodes-blotato.blotato","typeVersion":2,"position":[2768,1248],"id":"0156b63c-1f35-4547-afd9-60f296aad6c1","name":"InstagramCarrusel","retryOnFail":true,"onError":"continueErrorOutput"},{"parameters":{"platform":"facebook","accountId":{"__rl":true,"value":"={{ $node[\"masterVar\"].json['facebook'] }}","mode":"id"},"postContentText":"={{ $(\"varPostIMG\").item.json.CaptionFB }}","postContentMediaUrls":"={{ $json.url }}","facebookPageId":{"__rl":true,"value":"={{ $node[\"masterVar\"].json['facebook_page'] }}","mode":"id"},"options":{}},"type":"@blotato/n8n-nodes-blotato.blotato","typeVersion":2,"position":[1840,400],"id":"860870ea-e4a1-41ae-9de8-ff5123d58228","name":"FacebookPost","retryOnFail":true,"onError":"continueErrorOutput"},{"parameters":{"accountId":{"__rl":true,"value":"={{ $node[\"masterVar\"].json['instagram'] }}","mode":"id"},"postContentText":"={{ $(\"varPostIMG\").item.json.CaptionIN }}","postContentMediaUrls":"={{ $json.url }}","options":{}},"type":"@blotato/n8n-nodes-blotato.blotato","typeVersion":2,"position":[1840,560],"id":"fd728ebd-4834-40a4-b0ce-d9ca45bc5835","name":"InstagramPost","retryOnFail":true,"onError":"continueErrorOutput"}],"connections":{"Schedule Trigger1":{"main":[[{"node":"Code1","type":"main","index":0},{"node":"masterVar1","type":"main","index":0}]]},"Create an image from a template":{"main":[[{"node":"Wait12","type":"main","index":0}],[{"node":"⚠️​2","type":"main","index":0}]]},"Wait11":{"main":[[{"node":"CreateINPost","type":"main","index":0}]]},"⚠️​2":{"main":[[{"node":"No Operation, do nothing2","type":"main","index":0}]]},"Wait12":{"main":[[{"node":"Upload media","type":"main","index":0}]]},"Wait13":{"main":[[{"node":"CreateFBPost","type":"main","index":0}]]},"Wait15":{"main":[[{"node":"Merge4","type":"main","index":0}]]},"Loop Over Items2":{"main":[[{"node":"Code","type":"main","index":0}],[{"node":"slides","type":"main","index":0}]]},"Wait16":{"main":[[{"node":"varSlides1","type":"main","index":0}]]},"Code":{"main":[[{"node":"Merge4","type":"main","index":1}]]},"varSlides1":{"main":[[{"node":"Loop Over Items2","type":"main","index":0}]]},"Merge4":{"main":[[{"node":"imgSlide1","type":"main","index":0}]]},"imgSlide1":{"main":[[{"node":"Loop Over Items3","type":"main","index":0}]]},"Loop Over Items3":{"main":[[{"node":"mediaUrlsCarrusel1","type":"main","index":0}],[{"node":"Upload media1","type":"main","index":0}]]},"Wait17":{"main":[[{"node":"Loop Over Items3","type":"main","index":0}]]},"Merge5":{"main":[[{"node":"varPostCarrusel0","type":"main","index":0}]]},"Wait18":{"main":[[{"node":"Create a record6","type":"main","index":0}]]},"⚠️​3":{"main":[[{"node":"No Operation, do nothing3","type":"main","index":0}]]},"✅​3":{"main":[[{"node":"No Operation, do nothing3","type":"main","index":0}]]},"Create a record6":{"main":[[{"node":"Merge6","type":"main","index":0}]]},"Wait19":{"main":[[{"node":"Create a record7","type":"main","index":0}]]},"Create a record7":{"main":[[{"node":"Merge6","type":"main","index":1}]]},"mediaUrlsCarrusel1":{"main":[[{"node":"Merge5","type":"main","index":1}]]},"Merge6":{"main":[[{"node":"✅​3","type":"main","index":0}]]},"✅​1":{"main":[[{"node":"No Operation, do nothing2","type":"main","index":0}]]},"Merge7":{"main":[[{"node":"✅​1","type":"main","index":0}]]},"Wait":{"main":[[{"node":"masterVar","type":"main","index":0}]]},"Code1":{"main":[[{"node":"Wait","type":"main","index":0}]]},"masterVar":{"main":[[{"node":"Search records1","type":"main","index":0}]]},"OpenAI Chat Model":{"ai_languageModel":[[{"node":"AI Agent","type":"ai_languageModel","index":0}]]},"AI Agent":{"main":[[{"node":"Code in JavaScript","type":"main","index":0}]]},"Code in JavaScript":{"main":[[{"node":"Switch","type":"main","index":0}]]},"Switch":{"main":[[{"node":"varPostIMG","type":"main","index":0}],[{"node":"varPostCarrusel3","type":"main","index":0},{"node":"varPostCarruselCuerpo","type":"main","index":0},{"node":"varPostCarrusel2","type":"main","index":0}],[{"node":"varPostVideo","type":"main","index":0}]]},"varPostIMG":{"main":[[{"node":"fondoIMG","type":"main","index":0}]]},"fondoIMG":{"main":[[{"node":"Wait1","type":"main","index":0}]]},"Wait1":{"main":[[{"node":"Create an image from a template","type":"main","index":0}]]},"CreateINPost":{"main":[[{"node":"Merge7","type":"main","index":0}]]},"CreateFBPost":{"main":[[{"node":"Merge7","type":"main","index":1}]]},"fondoIMG1":{"main":[[{"node":"Wait2","type":"main","index":0}]]},"Wait2":{"main":[[{"node":"PortadaCarrusel","type":"main","index":0}]]},"PortadaCarrusel":{"main":[[{"node":"Wait15","type":"main","index":0}],[{"node":"⚠️​3","type":"main","index":0}]]},"Code in JavaScript1":{"main":[[{"node":"Loop Over Items2","type":"main","index":0}]]},"varPostCarruselCuerpo":{"main":[[{"node":"Code in JavaScript1","type":"main","index":0}]]},"slides":{"main":[[{"node":"Wait16","type":"main","index":0}],[{"node":"⚠️​3","type":"main","index":0}]]},"varPostCarrusel2":{"main":[[{"node":"Merge5","type":"main","index":0}]]},"varPostCarrusel3":{"main":[[{"node":"fondoIMG1","type":"main","index":0}]]},"varPostCarrusel0":{"main":[[{"node":"FacebookCarrusel","type":"main","index":0},{"node":"InstagramCarrusel","type":"main","index":0}]]},"Post Historicos":{"ai_tool":[[{"node":"AI Agent","type":"ai_tool","index":0}]]},"varPostVideo":{"main":[[{"node":"Create a video from a template","type":"main","index":0}]]},"Wait14":{"main":[[{"node":"CreateINPost1","type":"main","index":0}]]},"⚠️​":{"main":[[{"node":"No Operation, do nothing","type":"main","index":0}]]},"Wait20":{"main":[[{"node":"Upload media2","type":"main","index":0}]]},"Wait21":{"main":[[{"node":"CreateFBPost1","type":"main","index":0}]]},"✅​":{"main":[[{"node":"No Operation, do nothing","type":"main","index":0}]]},"Merge":{"main":[[{"node":"✅​","type":"main","index":0}]]},"CreateINPost1":{"main":[[{"node":"Merge","type":"main","index":0}]]},"CreateFBPost1":{"main":[[{"node":"Merge","type":"main","index":1}]]},"Create a video from a template":{"main":[[{"node":"Wait20","type":"main","index":0}],[{"node":"⚠️​","type":"main","index":0}]]},"masterVar1":{"main":[[{"node":"Search records","type":"main","index":0}]]},"Search records":{"main":[[{"node":"If","type":"main","index":0}]]},"If":{"main":[[{"node":"Code in JavaScript2","type":"main","index":0}],[{"node":"No Operation, do nothing1","type":"main","index":0}]]},"Code in JavaScript2":{"main":[[{"node":"Loop Over Items","type":"main","index":0}]]},"Loop Over Items":{"main":[[{"node":"No Operation, do nothing1","type":"main","index":0}],[{"node":"Delete a record","type":"main","index":0}]]},"Delete a record":{"main":[[{"node":"Loop Over Items","type":"main","index":0}]]},"When clicking ‘Execute workflow’":{"main":[[{"node":"masterVar","type":"main","index":0}]]},"Search records1":{"main":[[{"node":"variablesDinamicas","type":"main","index":0}]]},"variablesDinamicas":{"main":[[{"node":"AI Agent","type":"main","index":0}]]},"Upload media":{"main":[[{"node":"FacebookPost","type":"main","index":0},{"node":"InstagramPost","type":"main","index":0}],[{"node":"⚠️​2","type":"main","index":0}]]},"Upload media1":{"main":[[{"node":"Wait17","type":"main","index":0}],[{"node":"⚠️​3","type":"main","index":0}]]},"FacebookCarrusel":{"main":[[{"node":"Wait18","type":"main","index":0}],[{"node":"⚠️​3","type":"main","index":0}]]},"Upload media2":{"main":[[{"node":"FacebookReal","type":"main","index":0},{"node":"InstagramReal","type":"main","index":0},{"node":"InstagramStory","type":"main","index":0}]]},"FacebookReal":{"main":[[{"node":"Wait14","type":"main","index":0}],[{"node":"⚠️​","type":"main","index":0}]]},"InstagramReal":{"main":[[{"node":"Wait21","type":"main","index":0}],[{"node":"⚠️​","type":"main","index":0}]]},"InstagramStory":{"main":[[{"node":"Wait21","type":"main","index":0}],[{"node":"⚠️​","type":"main","index":0}]]},"InstagramCarrusel":{"main":[[{"node":"Wait19","type":"main","index":0}],[{"node":"⚠️​3","type":"main","index":0}]]},"FacebookPost":{"main":[[{"node":"Wait11","type":"main","index":0}],[{"node":"⚠️​2","type":"main","index":0}]]},"InstagramPost":{"main":[[{"node":"Wait13","type":"main","index":0}],[{"node":"⚠️​2","type":"main","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":null,"meta":null,"pinData":{"Schedule Trigger1":[{"json":{"timestamp":"2025-09-24T09:00:37.005-06:00","Readable date":"September 24th 2025, 9:00:37 am","Readable time":"9:00:37 am","Day of week":"Wednesday","Year":"2025","Month":"September","Day of month":"24","Hour":"09","Minute":"00","Second":"37","Timezone":"America/Mexico_City (UTC-06:00)"}}],"variablesDinamicas":[{"json":{"Tipo":"Carrusel","Color":"#512E88"}}]},"versionId":"148885c4-d12f-487d-8914-af4101a43dcc","activeVersionId":null,"versionCounter":2,"triggerCount":0,"shared":[{"updatedAt":"2026-01-05T21:52:45.504Z","createdAt":"2026-01-05T21:52:45.504Z","role":"workflow:owner","workflowId":"eSZWMMoTxuMotfMw","projectId":"ZrZEhploCo3SzGcR","project":{"updatedAt":"2026-01-05T04:06:43.891Z","createdAt":"2026-01-05T04:04:25.716Z","id":"ZrZEhploCo3SzGcR","name":"Admin KiroxOn <admin@kiroxon.com>","type":"personal","icon":null,"description":null,"projectRelations":[{"updatedAt":"2026-01-05T04:04:25.716Z","createdAt":"2026-01-05T04:04:25.716Z","userId":"81f20b86-05fa-4c10-a4c5-1d9ee6757629","projectId":"ZrZEhploCo3SzGcR","user":{"updatedAt":"2026-02-09T11:30:00.000Z","createdAt":"2026-01-05T04:04:24.404Z","id":"81f20b86-05fa-4c10-a4c5-1d9ee6757629","email":"admin@kiroxon.com","firstName":"Admin","lastName":"KiroxOn","personalizationAnswers":{"version":"v4","personalization_survey_submitted_at":"2026-01-05T04:07:15.797Z","personalization_survey_n8n_version":"1.103.2","companySize":"<20","companyType":"saas","role":"customer-support","reportedSource":"google"},"settings":{"userActivated":true,"easyAIWorkflowOnboarded":true,"firstSuccessfulWorkflowId":"YL3tGlIxXevhhOL3","userActivatedAt":1767649210078,"npsSurvey":{"responded":true,"lastShownAt":1767990714821}},"disabled":false,"mfaEnabled":false,"lastActiveAt":"2026-02-09","isPending":false}}]}}],"tags":[{"updatedAt":"2026-01-05T21:52:36.013Z","createdAt":"2026-01-05T21:52:36.013Z","id":"NMcHP8etRpwSn7yA","name":"Blotato"},{"updatedAt":"2026-01-05T04:42:50.080Z","createdAt":"2026-01-05T04:42:50.080Z","id":"WoZWCKdRNB9sNHTT","name":"Redes Sociales"},{"updatedAt":"2026-01-05T21:52:36.017Z","createdAt":"2026-01-05T21:52:36.017Z","id":"m6Xql0arnFi8YTKV","name":"Placid"}],"activeVersion":null}